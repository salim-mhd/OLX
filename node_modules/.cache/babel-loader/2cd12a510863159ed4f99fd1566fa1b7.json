{"ast":null,"code":"'use strict';\n\nexports.__esModule = true; // istanbul ignore next\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nvar _utils = require('../utils');\n\nvar _exception = require('../exception');\n\nvar _exception2 = _interopRequireDefault(_exception);\n\nexports['default'] = function (instance) {\n  instance.registerHelper('each', function (context, options) {\n    if (!options) {\n      throw new _exception2['default']('Must pass iterator to #each');\n    }\n\n    var fn = options.fn,\n        inverse = options.inverse,\n        i = 0,\n        ret = '',\n        data = undefined,\n        contextPath = undefined;\n\n    if (options.data && options.ids) {\n      contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]) + '.';\n    }\n\n    if (_utils.isFunction(context)) {\n      context = context.call(this);\n    }\n\n    if (options.data) {\n      data = _utils.createFrame(options.data);\n    }\n\n    function execIteration(field, index, last) {\n      if (data) {\n        data.key = field;\n        data.index = index;\n        data.first = index === 0;\n        data.last = !!last;\n\n        if (contextPath) {\n          data.contextPath = contextPath + field;\n        }\n      }\n\n      ret = ret + fn(context[field], {\n        data: data,\n        blockParams: _utils.blockParams([context[field], field], [contextPath + field, null])\n      });\n    }\n\n    if (context && typeof context === 'object') {\n      if (_utils.isArray(context)) {\n        for (var j = context.length; i < j; i++) {\n          if (i in context) {\n            execIteration(i, i, i === context.length - 1);\n          }\n        }\n      } else {\n        var priorKey = undefined;\n\n        for (var key in context) {\n          if (context.hasOwnProperty(key)) {\n            // We're running the iterations one step out of sync so we can detect\n            // the last iteration without have to scan the object twice and create\n            // an itermediate keys array.\n            if (priorKey !== undefined) {\n              execIteration(priorKey, i - 1);\n            }\n\n            priorKey = key;\n            i++;\n          }\n        }\n\n        if (priorKey !== undefined) {\n          execIteration(priorKey, i - 1, true);\n        }\n      }\n    }\n\n    if (i === 0) {\n      ret = inverse(this);\n    }\n\n    return ret;\n  });\n};\n\nmodule.exports = exports['default'];","map":{"version":3,"sources":["../../../../lib/handlebars/helpers/each.js"],"names":[],"mappings":";;;;;;;;;;qBAA+E,U;;yBACzD,c;;;;qBAEP,UAAS,QAAT,EAAmB;AAChC,EAAA,QAAQ,CAAC,cAAT,CAAwB,MAAxB,EAAgC,UAAS,OAAT,EAAkB,OAAlB,EAA2B;AACzD,QAAI,CAAC,OAAL,EAAc;AACZ,YAAM,IAAA,WAAA,CAAA,SAAA,CAAA,CAAc,6BAAd,CAAN;AACD;;AAED,QAAI,EAAE,GAAG,OAAO,CAAC,EAAjB;AAAA,QACI,OAAO,GAAG,OAAO,CAAC,OADtB;AAAA,QAEI,CAAC,GAAG,CAFR;AAAA,QAGI,GAAG,GAAG,EAHV;AAAA,QAII,IAAI,GAAA,SAJR;AAAA,QAKI,WAAW,GAAA,SALf;;AAOA,QAAI,OAAO,CAAC,IAAR,IAAgB,OAAO,CAAC,GAA5B,EAAiC;AAC/B,MAAA,WAAW,GAAG,MAAA,CAAA,iBAAA,CAAkB,OAAO,CAAC,IAAR,CAAa,WAA/B,EAA4C,OAAO,CAAC,GAAR,CAAY,CAAZ,CAA5C,IAA8D,GAA5E;AACD;;AAED,QAAI,MAAA,CAAA,UAAA,CAAW,OAAX,CAAJ,EAAyB;AAAE,MAAA,OAAO,GAAG,OAAO,CAAC,IAAR,CAAa,IAAb,CAAV;AAA+B;;AAE1D,QAAI,OAAO,CAAC,IAAZ,EAAkB;AAChB,MAAA,IAAI,GAAG,MAAA,CAAA,WAAA,CAAY,OAAO,CAAC,IAApB,CAAP;AACD;;AAED,aAAS,aAAT,CAAuB,KAAvB,EAA8B,KAA9B,EAAqC,IAArC,EAA2C;AACzC,UAAI,IAAJ,EAAU;AACR,QAAA,IAAI,CAAC,GAAL,GAAW,KAAX;AACA,QAAA,IAAI,CAAC,KAAL,GAAa,KAAb;AACA,QAAA,IAAI,CAAC,KAAL,GAAa,KAAK,KAAK,CAAvB;AACA,QAAA,IAAI,CAAC,IAAL,GAAY,CAAC,CAAC,IAAd;;AAEA,YAAI,WAAJ,EAAiB;AACf,UAAA,IAAI,CAAC,WAAL,GAAmB,WAAW,GAAG,KAAjC;AACD;AACF;;AAED,MAAA,GAAG,GAAG,GAAG,GAAG,EAAE,CAAC,OAAO,CAAC,KAAD,CAAR,EAAiB;AAC7B,QAAA,IAAI,EAAE,IADuB;AAE7B,QAAA,WAAW,EAAE,MAAA,CAAA,WAAA,CAAY,CAAC,OAAO,CAAC,KAAD,CAAR,EAAiB,KAAjB,CAAZ,EAAqC,CAAC,WAAW,GAAG,KAAf,EAAsB,IAAtB,CAArC;AAFgB,OAAjB,CAAd;AAID;;AAED,QAAI,OAAO,IAAI,OAAO,OAAP,KAAmB,QAAlC,EAA4C;AAC1C,UAAI,MAAA,CAAA,OAAA,CAAQ,OAAR,CAAJ,EAAsB;AACpB,aAAK,IAAI,CAAC,GAAG,OAAO,CAAC,MAArB,EAA6B,CAAC,GAAG,CAAjC,EAAoC,CAAC,EAArC,EAAyC;AACvC,cAAI,CAAC,IAAI,OAAT,EAAkB;AAChB,YAAA,aAAa,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAC,KAAK,OAAO,CAAC,MAAR,GAAiB,CAA9B,CAAb;AACD;AACF;AACF,OAND,MAMO;AACL,YAAI,QAAQ,GAAA,SAAZ;;AAEA,aAAK,IAAI,GAAT,IAAgB,OAAhB,EAAyB;AACvB,cAAI,OAAO,CAAC,cAAR,CAAuB,GAAvB,CAAJ,EAAiC;;;;AAI/B,gBAAI,QAAQ,KAAK,SAAjB,EAA4B;AAC1B,cAAA,aAAa,CAAC,QAAD,EAAW,CAAC,GAAG,CAAf,CAAb;AACD;;AACD,YAAA,QAAQ,GAAG,GAAX;AACA,YAAA,CAAC;AACF;AACF;;AACD,YAAI,QAAQ,KAAK,SAAjB,EAA4B;AAC1B,UAAA,aAAa,CAAC,QAAD,EAAW,CAAC,GAAG,CAAf,EAAkB,IAAlB,CAAb;AACD;AACF;AACF;;AAED,QAAI,CAAC,KAAK,CAAV,EAAa;AACX,MAAA,GAAG,GAAG,OAAO,CAAC,IAAD,CAAb;AACD;;AAED,WAAO,GAAP;AACD,GAzED;AA0ED,C","sourcesContent":["import {appendContextPath, blockParams, createFrame, isArray, isFunction} from '../utils';\nimport Exception from '../exception';\n\nexport default function(instance) {\n  instance.registerHelper('each', function(context, options) {\n    if (!options) {\n      throw new Exception('Must pass iterator to #each');\n    }\n\n    let fn = options.fn,\n        inverse = options.inverse,\n        i = 0,\n        ret = '',\n        data,\n        contextPath;\n\n    if (options.data && options.ids) {\n      contextPath = appendContextPath(options.data.contextPath, options.ids[0]) + '.';\n    }\n\n    if (isFunction(context)) { context = context.call(this); }\n\n    if (options.data) {\n      data = createFrame(options.data);\n    }\n\n    function execIteration(field, index, last) {\n      if (data) {\n        data.key = field;\n        data.index = index;\n        data.first = index === 0;\n        data.last = !!last;\n\n        if (contextPath) {\n          data.contextPath = contextPath + field;\n        }\n      }\n\n      ret = ret + fn(context[field], {\n        data: data,\n        blockParams: blockParams([context[field], field], [contextPath + field, null])\n      });\n    }\n\n    if (context && typeof context === 'object') {\n      if (isArray(context)) {\n        for (let j = context.length; i < j; i++) {\n          if (i in context) {\n            execIteration(i, i, i === context.length - 1);\n          }\n        }\n      } else {\n        let priorKey;\n\n        for (let key in context) {\n          if (context.hasOwnProperty(key)) {\n            // We're running the iterations one step out of sync so we can detect\n            // the last iteration without have to scan the object twice and create\n            // an itermediate keys array.\n            if (priorKey !== undefined) {\n              execIteration(priorKey, i - 1);\n            }\n            priorKey = key;\n            i++;\n          }\n        }\n        if (priorKey !== undefined) {\n          execIteration(priorKey, i - 1, true);\n        }\n      }\n    }\n\n    if (i === 0) {\n      ret = inverse(this);\n    }\n\n    return ret;\n  });\n}\n"]},"metadata":{},"sourceType":"script"}